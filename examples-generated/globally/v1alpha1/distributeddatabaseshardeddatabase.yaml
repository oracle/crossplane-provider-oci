apiVersion: globally.oci.upbound.io/v1alpha1
kind: DistributedDatabaseShardedDatabase
metadata:
  annotations:
    meta.upbound.io/example-id: globally/v1alpha1/distributeddatabaseshardeddatabase
  labels:
    testing.upbound.io/example-name: test_sharded_database
  name: test-sharded-database
spec:
  forProvider:
    catalogDetails:
    - adminPasswordSecretRef:
        key: example-key
        name: example-secret
        namespace: upbound-system
      cloudAutonomousVmClusterId: ${oci_database_cloud_autonomous_vm_cluster.test_cloud_autonomous_vm_cluster.id}
      computeCount: ${var.sharded_database_catalog_details_compute_count}
      dataStorageSizeInGbs: ${var.sharded_database_catalog_details_data_storage_size_in_gbs}
      encryptionKeyDetails:
      - kmsKeyId: ${oci_kms_key.test_key.id}
        kmsKeyVersionId: ${oci_kms_key_version.test_key_version.id}
        vaultId: ${oci_kms_vault.test_vault.id}
      isAutoScalingEnabled: ${var.sharded_database_catalog_details_is_auto_scaling_enabled}
      peerCloudAutonomousVmClusterId: ${oci_database_cloud_autonomous_vm_cluster.test_cloud_autonomous_vm_cluster.id}
    characterSet: ${var.sharded_database_character_set}
    chunks: ${var.sharded_database_chunks}
    clusterCertificateCommonName: ${var.sharded_database_cluster_certificate_common_name}
    compartmentId: ${var.compartment_id}
    dbDeploymentType: ${var.sharded_database_db_deployment_type}
    dbVersion: ${var.sharded_database_db_version}
    dbWorkload: ${var.sharded_database_db_workload}
    definedTags:
      foo-namespace.bar-key: value
    displayName: ${var.sharded_database_display_name}
    freeformTags:
      bar-key: value
    listenerPort: ${var.sharded_database_listener_port}
    listenerPortTls: ${var.sharded_database_listener_port_tls}
    ncharacterSet: ${var.sharded_database_ncharacter_set}
    onsPortLocal: ${var.sharded_database_ons_port_local}
    onsPortRemote: ${var.sharded_database_ons_port_remote}
    patchOperations:
    - operation: ${var.sharded_database_patch_operations_operation}
      selection: ${var.sharded_database_patch_operations_selection}
      value: ${var.sharded_database_patch_operations_value}
    prefix: ${var.sharded_database_prefix}
    replicationFactor: ${var.sharded_database_replication_factor}
    replicationMethod: ${var.sharded_database_replication_method}
    replicationUnit: ${var.sharded_database_replication_unit}
    shardDetails:
    - adminPasswordSecretRef:
        key: example-key
        name: example-secret
        namespace: upbound-system
      cloudAutonomousVmClusterId: ${oci_database_cloud_autonomous_vm_cluster.test_cloud_autonomous_vm_cluster.id}
      computeCount: ${var.sharded_database_shard_details_compute_count}
      dataStorageSizeInGbs: ${var.sharded_database_shard_details_data_storage_size_in_gbs}
      encryptionKeyDetails:
      - kmsKeyId: ${oci_kms_key.test_key.id}
        kmsKeyVersionId: ${oci_kms_key_version.test_key_version.id}
        vaultId: ${oci_kms_vault.test_vault.id}
      isAutoScalingEnabled: ${var.sharded_database_shard_details_is_auto_scaling_enabled}
      peerCloudAutonomousVmClusterId: ${oci_database_cloud_autonomous_vm_cluster.test_cloud_autonomous_vm_cluster.id}
      shardSpace: ${var.sharded_database_shard_details_shard_space}
    shardingMethod: ${var.sharded_database_sharding_method}
