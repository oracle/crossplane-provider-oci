apiVersion: database.oci.upbound.io/v1alpha1
kind: AutonomousContainerDatabase
metadata:
  annotations:
    meta.upbound.io/example-id: database/v1alpha1/autonomouscontainerdatabase
  labels:
    testing.upbound.io/example-name: test_autonomous_container_database
  name: test-autonomous-container-database
spec:
  forProvider:
    autonomousContainerDatabaseBackupId: ${oci_database_autonomous_container_database_backup.test_autonomous_container_database_backup.id}
    autonomousVmClusterId: ${oci_database_autonomous_vm_cluster.test_autonomous_vm_cluster.id}
    backupConfig:
    - backupDestinationDetails:
      - dbrs_policy_id: ${oci_identity_policy.test_policy.id}
        id: ${var.autonomous_container_database_backup_config_backup_destination_details_id}
        internetProxy: ${var.autonomous_container_database_backup_config_backup_destination_details_internet_proxy}
        isRemote: ${var.autonomous_container_database_backup_config_backup_destination_details_is_remote}
        remoteRegion: ${var.autonomous_container_database_backup_config_backup_destination_details_remote_region}
        type: ${var.autonomous_container_database_backup_config_backup_destination_details_type}
        vpcPasswordSecretRef:
          key: example-key
          name: example-secret
          namespace: upbound-system
        vpcUser: ${var.autonomous_container_database_backup_config_backup_destination_details_vpc_user}
      recoveryWindowInDays: ${var.autonomous_container_database_backup_config_recovery_window_in_days}
    cloudAutonomousVmClusterId: ${oci_database_cloud_autonomous_vm_cluster.test_cloud_autonomous_vm_cluster.id}
    compartmentIdSelector:
      matchLabels:
        testing.upbound.io/example-name: example
    customerContacts:
    - email: ${var.autonomous_container_database_customer_contacts_email}
    databaseSoftwareImageId: ${oci_database_database_software_image.test_database_software_image.id}
    dbName: ${var.autonomous_container_database_db_name}
    dbSplitThreshold: ${var.autonomous_container_database_db_split_threshold}
    dbUniqueName: ${var.autonomous_container_database_db_unique_name}
    dbVersion: ${var.autonomous_container_database_db_version}
    definedTags:
      Operations.CostCenter: "42"
    displayName: ${var.autonomous_container_database_display_name}
    distributionAffinity: ${var.autonomous_container_database_distribution_affinity}
    fastStartFailOverLagLimitInSeconds: ${var.autonomous_container_database_fast_start_fail_over_lag_limit_in_seconds}
    freeformTags:
      Department: Finance
    isAutomaticFailoverEnabled: ${var.autonomous_container_database_is_automatic_failover_enabled}
    isDstFileUpdateEnabled: ${var.autonomous_container_database_is_dst_file_update_enabled}
    keyStoreId: ${oci_database_key_store.test_key_store.id}
    kmsKeyId: ${oci_kms_key.test_key.id}
    maintenanceWindowDetails:
    - customActionTimeoutInMins: ${var.autonomous_container_database_maintenance_window_details_custom_action_timeout_in_mins}
      daysOfWeek:
      - name: ${var.autonomous_container_database_maintenance_window_details_days_of_week_name}
      hoursOfDay: ${var.autonomous_container_database_maintenance_window_details_hours_of_day}
      isCustomActionTimeoutEnabled: ${var.autonomous_container_database_maintenance_window_details_is_custom_action_timeout_enabled}
      isMonthlyPatchingEnabled: ${var.autonomous_container_database_maintenance_window_details_is_monthly_patching_enabled}
      leadTimeInWeeks: ${var.autonomous_container_database_maintenance_window_details_lead_time_in_weeks}
      months:
      - name: ${var.autonomous_container_database_maintenance_window_details_months_name}
      patchingMode: ${var.autonomous_container_database_maintenance_window_details_patching_mode}
      preference: ${var.autonomous_container_database_maintenance_window_details_preference}
      skipRu: ${var.autonomous_container_database_maintenance_window_details_skip_ru}
      weeksOfMonth: ${var.autonomous_container_database_maintenance_window_details_weeks_of_month}
    netServicesArchitecture: ${var.autonomous_container_database_net_services_architecture}
    okvEndPointGroupName: ${var.autonomous_container_database_okv_end_point_group_name}
    patchModel: ${var.autonomous_container_database_patch_model}
    peerAutonomousContainerDatabaseBackupConfig:
    - backupDestinationDetails:
      - dbrs_policy_id: ${oci_identity_policy.test_policy.id}
        id: ${var.autonomous_container_database_peer_autonomous_container_database_backup_config_backup_destination_details_id}
        internetProxy: ${var.autonomous_container_database_peer_autonomous_container_database_backup_config_backup_destination_details_internet_proxy}
        isRemote: ${var.autonomous_container_database_peer_autonomous_container_database_backup_config_backup_destination_details_is_remote}
        remoteRegion: ${var.autonomous_container_database_peer_autonomous_container_database_backup_config_backup_destination_details_remote_region}
        type: ${var.autonomous_container_database_peer_autonomous_container_database_backup_config_backup_destination_details_type}
        vpcPasswordSecretRef:
          key: example-key
          name: example-secret
          namespace: upbound-system
        vpcUser: ${var.autonomous_container_database_peer_autonomous_container_database_backup_config_backup_destination_details_vpc_user}
      recoveryWindowInDays: ${var.autonomous_container_database_peer_autonomous_container_database_backup_config_recovery_window_in_days}
    peerAutonomousContainerDatabaseCompartmentId: ${oci_identity_compartment.test_compartment.id}
    peerAutonomousContainerDatabaseDisplayName: ${var.autonomous_container_database_peer_autonomous_container_database_display_name}
    peerAutonomousVmClusterId: ${oci_database_autonomous_vm_cluster.test_autonomous_vm_cluster.id}
    peerCloudAutonomousVmClusterId: ${oci_database_cloud_autonomous_vm_cluster.test_cloud_autonomous_vm_cluster.id}
    peerDbUniqueName: ${var.autonomous_container_database_peer_db_unique_name}
    protectionMode: ${var.autonomous_container_database_protection_mode}
    serviceLevelAgreementType: ${var.autonomous_container_database_service_level_agreement_type}
    source: ${var.autonomous_container_database_source}
    standbyMaintenanceBufferInDays: ${var.autonomous_container_database_standby_maintenance_buffer_in_days}
    vaultId: ${oci_kms_vault.test_vault.id}
    versionPreference: ${var.autonomous_container_database_version_preference}
    vmFailoverReservation: ${var.autonomous_container_database_vm_failover_reservation}
