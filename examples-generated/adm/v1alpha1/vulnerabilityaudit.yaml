apiVersion: adm.oci.upbound.io/v1alpha1
kind: VulnerabilityAudit
metadata:
  annotations:
    meta.upbound.io/example-id: adm/v1alpha1/vulnerabilityaudit
  labels:
    testing.upbound.io/example-name: test_vulnerability_audit
  name: test-vulnerability-audit
spec:
  forProvider:
    applicationDependencies:
    - applicationDependencyNodeIds: ${var.vulnerability_audit_application_dependencies_application_dependency_node_ids}
      gav: ${var.vulnerability_audit_application_dependencies_gav}
      nodeId: ${oci_adm_node.test_node.id}
      purl: ${var.vulnerability_audit_application_dependencies_purl}
    buildType: ${var.vulnerability_audit_build_type}
    compartmentId: ${var.compartment_id}
    configuration:
    - exclusions: ${var.vulnerability_audit_configuration_exclusions}
      maxPermissibleCvssV2Score: ${var.vulnerability_audit_configuration_max_permissible_cvss_v2score}
      maxPermissibleCvssV3Score: ${var.vulnerability_audit_configuration_max_permissible_cvss_v3score}
      maxPermissibleSeverity: ${var.vulnerability_audit_configuration_max_permissible_severity}
    definedTags:
      foo-namespace.bar-key: value
    displayName: ${var.vulnerability_audit_display_name}
    freeformTags:
      bar-key: value
    knowledgeBaseId: ${oci_adm_knowledge_base.test_knowledge_base.id}
    source:
    - description: ${var.vulnerability_audit_source_description}
      ociResourceId: ${oci_adm_oci_resource.test_oci_resource.id}
      type: ${var.vulnerability_audit_source_type}
    usageData:
    - bucket: ${var.vulnerability_audit_usage_data_bucket}
      namespace: ${var.vulnerability_audit_usage_data_namespace}
      object: ${var.vulnerability_audit_usage_data_object}
      sourceType: ${var.vulnerability_audit_usage_data_source_type}
